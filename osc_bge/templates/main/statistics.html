{% extends 'base.html' %}
{% load static templatehelpers %}
{% block content %}

<div class="ContentsFrame">

	<div class="MainAFrame" id="MainF">

		<div class="MTitle">New Students</div>
		<div class="ListSearch Aright">
			<form method="GET">
				<div>
				From :
				<select class="SearchSelect" name="start_month">
					<option value="">Select Month..</option>
					<option >Dec</option>
					<option >Nov</option>
					<option >Oct</option>
					<option >Sep</option>
					<option >Aug</option>
					<option >Jul</option>
					<option >Jun</option>
					<option >May</option>
					<option >Apr</option>
					<option >Mar</>
					<option >Feb</option>
					<option >Jan</option>
				</select>
				&nbsp;&nbsp;
				To :
				<select class="SearchSelect" name="end_month">
					<option value="">Select Month..</option>
					<option>Dec</option>
					<option>Nov</option>
					<option>Oct</option>
					<option>Sep</option>
					<option>Aug</option>
					<option>Jul</option>
					<option>Jun</option>
					<option>May</option>
					<option>Apr</option>
					<option>Mar</>
					<option>Feb</option>
					<option>Jan</option>
				</select>
				&nbsp;&nbsp;
				<select class="SearchSelect" name="year">
					<option value="">Select year..</option>
					{% for year in year_list %}
					<option value="{{year}}">{{year}} ~ {{year|add:1}} year</option>
					{% endfor %}
				</select>

				<select class="SearchSelect" name="program_interested">
					<option value=""> Select Program</option>
					<option value="k12">Secondary</option>
					<option value="college">College</option>
					<option value="camp">Camp</option>
					<option value="not_specified">Not specified</option>
				</select>
				</div>
				<button type="submit" class="ListSearchButton">Search<button>
			</form>
		</div>

		<div class="AgentFrameL">
			<div class="ListTable">
				<table cellpadding="0" cellspacing="0" border="0">
					<colgroup>
						<col width="180">
						<col>
					</colgroup>
					<tr>
						<th>agent</th>
						<th>inquired</th>
						<th>Applied</th>
						<th>Accepted</th>
						<th>Cancelled</th>
						<th>Enrolled</th>
					</tr>
					{% for head in all_agent_heads %}
					<tr>
						<td>{{head.name}}</td>
						<td>{{head.inquired}}</td>
						<td>{{head.applied}}</td>
						<td>{{head.accepted}}</td>
						<td>{{head.cancelled}}</td>
						<td>{{head.enrolled}}</td>
					</tr>
					{% endfor %}
					<tr>
						<td class="TitleColor">Total</td>
						<td class="TitleColor">{{total_inquired}}</td>
						<td class="TitleColor">{{total_applied}}</td>
						<td class="TitleColor">{{total_accepted_percent}}%</td>
						<td class="TitleColor">{{total_cancelled}}</td>
						<td class="TitleColor">{{total_enrolled}}</td>
					</tr>
				</table>
			</div><!-- ListTable -->
		</div><!-- AgentFrameL -->

		<div class="AgentFrameR">
			<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
			<script type="text/javascript">
			  google.charts.load('current', {'packages':['line']});
			  google.charts.setOnLoadCallback(drawChart);

			function drawChart() {

			  var data = new google.visualization.DataTable();
			  data.addColumn('number', 'year');
			  data.addColumn('number', 'Meten');
			  data.addColumn('number', 'Yangzhou');
			  data.addColumn('number', 'AsiaUS');
			  data.addColumn('number', 'Other(BGE Staff)');

			  data.addRows([
				[2018,  37.8, 80.8, 41.8, 10],
				[2019,  30.9, 69.5, 32.4, 10],
				[2020,  25.4,   57, 25.7, 10],
				[2021,  11.7, 18.8, 10.5, 10],
				[2022,  11.9, 17.6, 10.4, 10],
			  ]);

			  var options = {

//				chart: {
//				  title: 'Box Office Earnings in First Two Weeks of Opening',
//				  subtitle: 'in millions of dollars (USD)'
//				},
				width: 600,
				height: 190,
				axes: {
				  x: {
					0: {side: 'bottom'}
				  }
				}
			  };

			  var chart = new google.charts.Line(document.getElementById('line_top_x'));

			  chart.draw(data, google.charts.Line.convertOptions(options));
			}
		  </script>
			<div id="line_top_x"></div>
		</div><!-- AgentFrameR -->


		<div class="ListTable">
			<form method="GET">
				<div class="ListSearch Aright">
					<div class="InfoTable" ><span class="AddComment">Default : {{default_start_date|date:"Y-m-d"}} ~ {{default_end_date|date:"Y-m-d"}}</span></div>

					<div>
					<select class="SearchSelect" name="new_week">
						<option value="">Week</option>
						{% for week in week_list%}
						<option value="{{week.0|date:'Y-m-d'}}">{{week.1|date:"Y-m-d"}} ~ {{week.0|date:"Y-m-d"}}</option>
						{% endfor %}
					</select>

					<select class="SearchSelect" name="new_day">
						<option value="">Day</option>
						{% for day in day_list %}
						<option>{{day|date:"Y-m-d"}}</option>
						{% endfor %}
					</select>

					<select class="SearchSelect" name="new_program">
						<option value="">Program</option>
						<option value="k12">Secondary</option>
						<option value="college">College</option>
						<option value="camp">Camp</option>
						<option value="not_specified">Not specified</option>
					</select>
					</div>
					<button type="submit" class="ListSearchButton" >Search</button>
				</div>
			</form>
			<table cellpadding="0" cellspacing="0" border="0">
				<colgroup>
					<col width="180">
					<col>
				</colgroup>
				<tr>
					<th>agent</th>
					<th>new inquired</th>
					<th>new Applied</th>
					<th>new Accepted</th>
					<th>new Cancelled</th>
					<th>new Enrolled</th>
				</tr>
				{% for head in all_agent_heads %}
				<tr>
					<td>{{head.name}}</td>
					<td>{{head.new_inquired}}</td>
					<td>{{head.new_applied}}</td>
					<td>{{head.new_accepted}}</td>
					<td>{{head.new_cancelled}}</td>
					<td>{{head.new_enrolled}}</td>
				</tr>
				{% endfor %}
				<tr>
					<td class="TitleColor">Total</td>
					<td class="TitleColor">{{new_total_inquired}}</td>
					<td class="TitleColor">{{new_total_applied}}</td>
					<td class="TitleColor">{{new_total_accepted_percent}}%</td>
					<td class="TitleColor">{{new_total_cancelled}}</td>
					<td class="TitleColor">{{new_total_enrolled}}</td>
				</tr>
			</table>
		</div><!-- ListTable -->
		<div class="EndPart"></div>
		<div class="cdiv"></div>



		<div class="MTitle">Customer Search</div>
		<div class="ListSearch Aright">
			<form method="GET">
				<div>
				<select class="SearchSelect" name="agent_head">
					<option value="">Agent</option>
					{% for head in all_agent_heads %}
					<option value="{{head.id}}">{{head.name}}</option>
					{% endfor %}
				</select>
				<select class="SearchSelect" name="customer_program">
					<option value="">Program</option>
					<option value="k12">Secondary</option>
					<option value="college">College</option>
					<option value="college">Camp</option>
				</select>
				<select class="SearchSelect" name="customer_country">
					<option value="">Country</option>
					<option value="korea">Korea</option>
					<option value="china">China</option>
					<option value="vietnam">Vietnam</option>
				</select>
				<select class="SearchSelect" name="customer_search_type">
					<option value="name">Name</option>
					<option value="phone">Phone</option>
					<option value="email">E-mail</option>
				</select>
	        <input type="text" class="SearchInput" style="width:150px;" name="search_input"/>
	        <button type="submit" class="ListSearchButton">Search</button>
				</div>
			</form>
		</div>

		<div class="ListTable">
			<table cellpadding="0" cellspacing="0" border="0">
				<colgroup>
					<col width="180">
					<col>
				</colgroup>
				<tr>
					<th>Agent</th>
					<th>Counselor</th>
					<th>Student</th>
					<th>Program</th>
					<th>Country</th>
					<th>Inquired</th>
					<th>Applied</th>
					<th>Accepted</th>
					<th>Cancelled</th>
					<th>Enrolled</th>
					<th>Entrance</th>
				</tr>
				{% for counsel in counsels %}
				<tr>
					<td>{{counsel.counselor.agency.head.name}}</td>
					<td>{{counsel.counselor.user.first_name}} {{counsel.counselor.user.last_name}}</td>
					<td>{{counsel.student.name}}</td>
					<td>{{counsel.program_interested}}</td>
					<td>{{counsel.desire_country}}</td>
					<td>{{counsel.created_at|date:"Y-m-d"}}</td>
					<td>{{counsel.formality.apply_at|date:"Y-m-d"}}</td>
					<td>{{counsel.acceptance_date|date:"Y-m-d"}}</td>
					<td>{{counsel.cancel_enrolment_date|date:"Y-m-d"}}</td>
					<td>{{counsel.i20_received_date|date:"Y-m-d"}}</td>
					<td>{{counsel.formality.air_arrive_date|date:"Y-m-d"}}</td>
				</tr>
				{% endfor %}
			</table>
		</div><!-- ListTable -->
		<div class="ListCounter">
      {% if counsels.has_other_pages %}
        {% for i in counsels.paginator.page_range %}
          {% if counsels.number == i %}
            <span>{{ i }}</span>
          {% else %}
            <a href="{% relative_url i 'page' request.GET.urlencode %}">{{ i }}</a>
          {% endif %}
        {% endfor %}
      {% endif %}
    </div>



	</div><!-- MainFrame -->
</div><!--  ContentsFrame-->
{% endblock %}
